<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Navigation */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: bold;
            color: #000;
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: #000;
            font-size: 16px;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .auth-button {
            background-color: #3a2f35;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        /* Hero Section */
        .hero {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f5f7fa;
            border-radius: 10px;
            padding: 60px 40px;
            margin-top: 20px;
        }

        .hero-content {
            max-width: 500px;
        }

        .hero-title {
            font-size: 48px;
            font-weight: bold;
            line-height: 1.2;
            margin-bottom: 20px;
            color: #000;
        }

        .hero-text {
            font-size: 18px;
            line-height: 1.6;
            color: #555;
            margin-bottom: 30px;
        }

        .cta-button {
            background-color: #3a2f35;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 15px 30px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
        }

        .hero-image {
            width: 400px;
            height: auto;
        }

        /* Floating Chatbot Button */
        .chatbot-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: #3a2f35;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease-in-out;
            z-index: 999;
        }

        .chatbot-icon:hover {
            transform: scale(1.1);
        }

        .chatbot-icon img {
            width: 40px;
            height: 40px;
        }

        /* Chatbot Popup */
        .chatbot-popup {
            display: none;
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 350px;
            height: 450px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .chatbot-header {
            background-color: #3a2f35;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            position: relative;
        }

        .chatbot-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .chatbot-message {
            padding: 10px;
            border-radius: 8px;
            max-width: 80%;
        }

        .user-message {
            background-color: #f0f0f0;
            align-self: flex-end;
        }

        .bot-message {
            background-color: #e1f5fe;
            align-self: flex-start;
        }

        .chatbot-input-container {
            display: flex;
            padding: 10px;
            border-top: 1px solid #e0e0e0;
        }

        .chatbot-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            margin-right: 10px;
            outline: none;
        }

        .chatbot-send-btn {
            background-color: #3a2f35;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 15px;
            cursor: pointer;
        }

        .chatbot-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 18px;
            color: white;
            cursor: pointer;
        }

        /* Flash messages */
        .flash-messages {
            margin: 10px 0;
        }

        .flash {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .flash.success {
            background-color: #d4edda;
            color: #155724;
        }

        .flash.danger {
            background-color: #f8d7da;
            color: #721c24;
        }

        .flash.info {
            background-color: #d1ecf1;
            color: #0c5460;
        }
    </style>
    <title>Neighborly - Connect with your neighborhood</title>
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <nav>
            <div class="logo-container">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Neighborly Logo" width="50" height="60">
                <span class="logo-text">Neighborly</span>
            </div>
            
            <div class="nav-links">
                <a href="{{ url_for('home') }}">Home</a>
                <div class="dropdown">
                    <a href="{{ url_for('complaintsform') }}">Complaints &#9662;</a>
                </div>
                <a href="#">About Us</a>
                <a href="{{ url_for('events') }}">Events</a>
                {% if session.get('is_admin') %}
                    <a href="{{ url_for('add_event') }}">Add Event</a>
                {% endif %}
            </div>
            
            {% if session.get('user_id') %}
                <button class="auth-button" onclick="window.location.href='/logout'">Logout</button>
            {% else %}
                <button class="auth-button" onclick="window.location.href='/signup'">Register / Login</button>
            {% endif %}
        </nav>
        
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="flash {{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-content">
                <h1 class="hero-title">Connect with your neighborhood like never before.</h1>
                <p class="hero-text">Join Neighborly to stay updated on community events, local services, and neighborhood updates.</p>
                <button class="cta-button" onclick="window.location.href='/housingreg'">Get Started Today</button>
            </div>
            
            <div class="hero-image-container">
                <img src="{{ url_for('static', filename='images/pic1.png') }}" alt="Neighborhood view with decorative circles" class="hero-image">
            </div>
        </section>
        <div id="community-sec"></div>
          <script>
             fetch('community-section.html')
            .then(response => response.text())
            .then(html => document.getElementById('community-section').innerHTML = html);
          </script>
          <div id="raise-voice"></div>
          <script>
              fetch('/raise')
            .then(response => response.text())
            .then(html => document.getElementById('raise-voice').innerHTML = html);

          </script>
        <div id="testi"></div>
        
        <script>
            fetch('/testi')
            .then(response => response.text())
            .then(html => document.getElementById('testi').innerHTML = html);
        </script>

       <!-- Floating Chatbot Button -->
<div class="chatbot-icon" id="chatbot-button">
    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
</div>

<!-- Chatbot Popup -->
<div class="chatbot-popup" id="chatbot-popup" style="display: none;">
    <div class="chatbot-header">
        Neighborly Assistant
        <span class="chatbot-close" id="chatbot-close">×</span>
    </div>
    <div class="chatbot-body" id="chatbot-body">
        <div class="chatbot-message bot-message">Hi there! How can I help you today? Please select from the options below:</div>
        <div class="chatbot-message bot-message" id="menu-options">
            1️⃣ What is Neighborly?<br>
            2️⃣ How can I report a complaint?<br>
            3️⃣ How do I join community events?<br>
            4️⃣ Can I raise awareness about an issue?<br>
            5️⃣ How do I register for Neighborly?<br>
            6️⃣ Who manages Neighborly?<br>
            7️⃣ Is Neighborly free to use?<br>
            8️⃣ How can I contact support?
        </div>
    </div>
    <div class="chatbot-input-container">
        <input type="text" class="chatbot-input" id="chatbot-input" placeholder="Type 1-8 or your question..." />
        <button class="chatbot-send-btn" id="chatbot-send">Send</button>
    </div>
</div>

<script>
    // Chatbot functionality
    document.addEventListener('DOMContentLoaded', function() {
        // Get chatbot elements
        const chatbotButton = document.getElementById('chatbot-button');
        const chatbotPopup = document.getElementById('chatbot-popup');
        const chatbotClose = document.getElementById('chatbot-close');
        const chatbotInput = document.getElementById('chatbot-input');
        const chatbotSend = document.getElementById('chatbot-send');
        const chatbotBody = document.getElementById('chatbot-body');
        
        // Check if elements exist to prevent errors
        if (!chatbotButton || !chatbotPopup || !chatbotClose || !chatbotInput || !chatbotSend || !chatbotBody) {
            console.error('Chatbot elements not found');
            return;
        }
        
        // Predefined answers
        const answers = {
            "1": "👉 Neighborly is a community platform that helps residents stay connected, report issues, participate in local events, and support neighborhood initiatives.",
            "2": "👉 You can report a complaint by visiting the **\"Complaints\"** section on our website and filling out the form. Once submitted, local authorities or community admins will review it.",
            "3": "👉 Simply go to the **\"Events\"** section to see upcoming activities in your neighborhood. You can click on an event to view details and register.",
            "4": "👉 Yes! Use the **\"Raise Your Voice\"** section to highlight concerns, share initiatives, or rally support for community-driven projects.",
            "5": "👉 Click the **\"Register / Login\"** button on the homepage and sign up using your email. Once registered, you can access all features.",
            "6": "👉 Neighborly is managed by local community admins who oversee events, complaints, and general platform engagement. If you're an admin, you can log in to add events and manage issues.",
            "7": "👉 Yes! Neighborly is completely free for residents to use and participate in.",
            "8": "👉 If you need help, you can reach out via the **\"Contact Us\"** page or email our support team at **support@neighborly.com**."
        };
        
        // Keywords for natural language processing
        const keywords = {
            "what is|about|purpose": "1",
            "report|complaint|issue|problem": "2",
            "event|join event|community event": "3",
            "raise|awareness|voice|concern": "4",
            "register|signup|sign up|login|log in": "5",
            "manage|admin|administrator": "6",
            "free|cost|price|payment": "7",
            "contact|support|help|email": "8"
        };

        // Toggle chatbot popup
        chatbotButton.addEventListener('click', function() {
            chatbotPopup.style.display = 'flex';
            chatbotInput.focus();
        });

        // Close chatbot popup
        chatbotClose.addEventListener('click', function() {
            chatbotPopup.style.display = 'none';
        });

        // Send message on Enter key
        chatbotInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Send message on button click
        chatbotSend.addEventListener('click', sendMessage);

        function sendMessage() {
            const message = chatbotInput.value.trim();
            if (message) {
                // Add user message to chat
                addMessage(message, 'user');
                
                // Clear input
                chatbotInput.value = '';
                
                // Process the message
                processMessage(message);
            }
        }
        
        function processMessage(message) {
            // Check if the message is just a number from 1-8
            if (/^[1-8]$/.test(message)) {
                respondToOption(message);
                return;
            }
            
            // Check for keywords in the message
            let foundMatch = false;
            for (const [key, value] of Object.entries(keywords)) {
                const regex = new RegExp(key, 'i');
                if (regex.test(message)) {
                    respondToOption(value);
                    foundMatch = true;
                    break;
                }
            }
            
            // Default response if no match found
            if (!foundMatch) {
                setTimeout(() => {
                    addMessage("I'm not sure I understand. Please select an option from 1-8 or ask a more specific question about Neighborly.", 'bot');
                    // Show the menu again
                    setTimeout(() => {
                        const menuOptions = document.getElementById('menu-options').innerHTML;
                        addMessage(menuOptions, 'bot');
                    }, 300);
                }, 500);
            }
        }
        
        function respondToOption(option) {
            if (answers[option]) {
                // Use setTimeout to simulate a brief delay in response
                setTimeout(() => {
                    // Replace ** with bold text
                    let formattedAnswer = answers[option].replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    
                    const messageElement = document.createElement('div');
                    messageElement.className = 'chatbot-message bot-message';
                    messageElement.innerHTML = formattedAnswer;
                    chatbotBody.appendChild(messageElement);
                    
                    // Add "anything else" follow-up after a short delay
                    setTimeout(() => {
                        addMessage("Is there anything else I can help you with? Please select another option or type your question.", 'bot');
                    }, 800);
                    
                    // Scroll to bottom
                    chatbotBody.scrollTop = chatbotBody.scrollHeight;
                }, 500);
            }
        }

        function addMessage(message, sender) {
            const messageElement = document.createElement('div');
            messageElement.className = sender === 'user' ? 'chatbot-message user-message' : 'chatbot-message bot-message';
            
            // For bot messages that are menus, we want to preserve line breaks
            if (message.includes('<br>')) {
                messageElement.innerHTML = message;
            } else {
                messageElement.textContent = message;
            }
            
            chatbotBody.appendChild(messageElement);
            
            // Scroll to the latest message
            chatbotBody.scrollTop = chatbotBody.scrollHeight;
        }
    });
</script>
    </div>
</body>
</html>
